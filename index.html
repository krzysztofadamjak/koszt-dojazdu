<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Kalkulator kosztu dojazdu</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 1em; max-width: 600px; margin: auto; }
    label { display: block; margin-top: 1em; }
    input, select, button { width: 100%; padding: 0.5em; margin-top: 0.2em; }
    #map { height: 0; visibility: hidden; }
    #wynik { margin-top: 1em; padding: 1em; background: #f0f0f0; border-radius: 8px; }
  </style>
</head>
<body>
  <h2>Kalkulator dojazdu do pracy</h2>

  <label>Adres domowy:
    <input id="home" type="text" placeholder="np. Warszawa, ul. Długa 5" />
  </label>

  <label>Adres pracy:
    <input id="work" type="text" placeholder="np. Warszawa, ul. Krótka 1" />
  </label>

  <label>Rodzaj paliwa:
    <select id="fuel">
      <option value="95">PB95</option>
      <option value="98">PB98</option>
      <option value="ON">Diesel</option>
      <option value="LPG">LPG</option>
    </select>
  </label>

  <label>Województwo:
    <select id="region">
      <option value="mazowieckie">Mazowieckie</option>
      <option value="małopolskie">Małopolskie</option>
      <option value="wielkopolskie">Wielkopolskie</option>
    </select>
  </label>

  <label>Średnie spalanie (l/100 km):
    <input type="number" id="consumption" value="7.0" step="0.1">
  </label>

  <button onclick="oblicz()">Oblicz koszt i czas</button>

  <div id="wynik"></div>
  <div id="map"></div>

  <script>
    const cenyPaliw = {
      mazowieckie: { "95": 5.72, "98": 6.49, "ON": 5.88, "LPG": 2.93 },
      małopolskie: { "95": 5.75, "98": 6.55, "ON": 5.90, "LPG": 2.95 },
      wielkopolskie: { "95": 5.68, "98": 6.42, "ON": 5.81, "LPG": 2.89 }
    };

    let map, directionsService;

    function initMap() {
      map = new google.maps.Map(document.getElementById("map"), {
        center: { lat: 52.2297, lng: 21.0122 },
        zoom: 12
      });
      directionsService = new google.maps.DirectionsService();

      new google.maps.places.Autocomplete(document.getElementById("home"));
      new google.maps.places.Autocomplete(document.getElementById("work"));
    }

    function oblicz() {
      const origin = document.getElementById("home").value;
      const destination = document.getElementById("work").value;
      const fuel = document.getElementById("fuel").value;
      const region = document.getElementById("region").value;
      const spalanie = parseFloat(document.getElementById("consumption").value);
      const wynik = document.getElementById("wynik");

      if (!origin || !destination || isNaN(spalanie)) {
        wynik.innerHTML = "<p style='color:red;'>Uzupełnij wszystkie pola poprawnie.</p>";
        return;
      }

      directionsService.route(
        {
          origin,
          destination,
          travelMode: google.maps.TravelMode.DRIVING
        },
        (response, status) => {
          if (status === "OK") {
            const distanceKm = response.routes[0].legs[0].distance.value / 1000;
            const duration = response.routes[0].legs[0].duration.text;
            const cena = cenyPaliw[region][fuel];
            const zuzycie = (distanceKm * spalanie) / 100;
            const koszt = zuzycie * cena;

            wynik.innerHTML = `
              <p><strong>Dystans:</strong> ${distanceKm.toFixed(1)} km</p>
              <p><strong>Średni czas przejazdu:</strong> ${duration}</p>
              <p><strong>Zużycie paliwa:</strong> ${zuzycie.toFixed(1)} l</p>
              <p><strong>Koszt jednego dojazdu:</strong> <strong>${koszt.toFixed(2)} zł</strong></p>
            `;
          } else {
            wynik.innerHTML = "<p style='color:red;'>Nie udało się obliczyć trasy.</p>";
          }
        }
      );
    }
  </script>

  <script async
    src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places&callback=initMap">
  </script>
</body>
</html>
